import{a as g,i as D}from"./vendor-4yCzdkXl.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const a of c)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function o(c){const a={};return c.integrity&&(a.integrity=c.integrity),c.referrerPolicy&&(a.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?a.credentials="include":c.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(c){if(c.ep)return;c.ep=!0;const a=o(c);fetch(c.href,a)}})();const H="https://dummyjson.com",_={PRODUCTS:"/products",PRODUCT_BY_ID:"/products/",SEARCH_PRODUCTS:"/products/search",CATEGORIES:"/products/category-list",PRODUCTS_BY_CATEGORY:"/products/category/"},$=12;g.defaults.baseURL=H;async function C(t){const e=(t-1)*$,{data:o}=await g.get(`${_.PRODUCTS}?limit=${$}&skip=${e}`);return o}async function F(){const{data:t}=await g.get(`${_.CATEGORIES}`);return t}async function P(t){const{data:e}=await g.get(`${_.PRODUCT_BY_ID}${t}`);return e}async function U(t){const{data:e}=await g.get(`${_.SEARCH_PRODUCTS}?q=${t}`);return e}async function W(t){const{data:e}=await g.get(`${_.PRODUCTS_BY_CATEGORY}${t}`);return e}function h(t){return Promise.all(t.map(e=>P(e)))}function y(t,e,o){t.forEach(n=>{n.classList.remove(o)}),e.classList.add(o)}function E(t,e){t.forEach(o=>{o.classList.remove(e)})}function f(t,e){return e.some(o=>o===t)}function T(t,e){return t.reduce((o,{price:n,id:c})=>e.some(a=>a===c)?o+Math.ceil(n):o,0)}const r={categoriesList:document.querySelector(".categories"),modalProduct:document.querySelector(".modal-product"),productsList:document.querySelector(".products"),modal:document.querySelector(".modal"),modalCloseBtn:document.querySelector(".modal__close-btn"),modalCartBtn:document.querySelector(".modal-product__btn--cart"),modalWishBtn:document.querySelector(".modal-product__btn--wishlist"),searchForm:document.querySelector(".search-form"),searchInput:document.querySelector(".search-form__input"),searchFormBtnClear:document.querySelector(".search-form__btn-clear"),notFoundMes:document.querySelector(".not-found")};function x(t){const o=["All",...t].map(n=>`
      <li class="categories__item">
        <button class="categories__btn" type="button">${n}</button>
      </li>
    `).join("");r.categoriesList.innerHTML=o}function N({thumbnail:t,title:e,tags:o,description:n,shippingInformation:c,returnPolicy:a,price:m,id:w}){const k=o?`<ul class="modal-product__tags">${o.map(I=>`<li class="modal-product__tag">${I}</li>`).join("")}</ul>`:"",R=`<img class="modal-product__img" src="${t}" alt="${e}" />
            <div class="modal-product__content">
            <p class="modal-product__title">${e}</p>
            ${k}
            <p class="modal-product__description">${n}</p>
            <p class="modal-product__shipping-information">Shipping: ${c}</p>
            <p class="modal-product__return-policy">Return Policy: ${a}</p>
            <p class="modal-product__price">Price: ${m}$</p>
            <button class="modal-product__buy-btn" type="button">Buy</button>
            </div>`;r.modalProduct.innerHTML=R}function d(t){const e=t.map(({id:o,title:n,thumbnail:c,category:a,price:m,brand:w})=>`
    <li class="products__item" data-id="${o}">
        <img class="products__image" src="${c}" alt="${n}" />
        <p class="products__title">${n}</p>
        <p class="products__brand"><span class="products__brand--bold">Brand:</span> ${w}</p>
        <p class="products__category">Category: ${a}</p>
        <p class="products__price">Price: $${m}</p>
    </li>
  `).join("");r.productsList.insertAdjacentHTML("beforeend",e)}function u(t,e){const o=document.querySelector(`.nav__count[data-${t}-count]`),n=`${t}Count`;o.dataset[n]=e,o.textContent=e}function b(t,e,o){r.modalCartBtn.textContent=f(t,e)?"Remove from cart":"Add to Cart",r.modalWishBtn.textContent=f(t,o)?"Remove from Wishlist":"Add to Wishlist"}function S(t,e){const o=document.querySelector(".cart-summary__value[data-count]"),n=document.querySelector(".cart-summary__value[data-price]");o.textContent=t.length,o.dataset.count=t.length,n.textContent=`$${~~e}`,n.dataset.price=e}function j(){r.modal.classList.add("modal--is-open"),document.body.style.overflow="hidden",window.addEventListener("keydown",B),r.modal.addEventListener("click",q),r.modalCloseBtn.addEventListener("click",L),r.modalCartBtn.addEventListener("click",M),r.modalWishBtn.addEventListener("click",O)}function L(){r.modal.classList.remove("modal--is-open"),document.body.style.overflow="",window.removeEventListener("keydown",B),r.modal.removeEventListener("click",q),r.modalCloseBtn.removeEventListener("click",L),r.modalCartBtn.removeEventListener("click",M),r.modalWishBtn.removeEventListener("click",O)}function B(t){t.key==="Escape"&&L()}function q(t){t.target===r.modal&&L()}function p(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch{return D.error({message:`Error during loading from LS for key "${t}": ${err}`}),null}}function A(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(o){console.error(`SaveToLS error: ${o}`)}}let v=1,l,s,i;async function G(){s=p("cart")??[],i=p("wishlist")??[],u("cart",s.length),u("wishlist",i.length);try{const t=await F();x(t),y(document.querySelectorAll(".categories__btn"),document.querySelector(".categories__btn"),"categories__btn--active");const{products:e,total:o}=await C(v);if(!(e!=null&&e.length)){document.querySelector(".not-found").classList.add("not-found--visible"),E(document.querySelectorAll(".categories__btn"),"categories__btn--active");return}d(e)}catch(t){console.error(`Error init page, ${t}`)}}async function J(t){if(t.target.nodeName!=="BUTTON")return;r.productsList.innerHTML="";const e=t.target.textContent.toLowerCase(),o=document.querySelectorAll(".categories__btn");y(o,t.target,"categories__btn--active");try{const{products:n}=await(e==="all"?C(v):W(e));d(n)}catch(n){console.error("Something went wrong during choosing products category:",n)}r.searchForm.reset()}async function K(t){const e=t.target.closest(".products__item");if(e)try{const o=+e.dataset.id;l=o;const n=await P(o);N(n),j(),b(l,s,i)}catch(o){console.error("Error during loading product: ",o)}}async function z(t){t.preventDefault();const e=t.target.elements.searchValue.value.trim();if(!e){console.error("Please, fill the input"),t.target.reset();return}try{r.productsList.innerHTML="";const{products:o}=await U(e);if(!(o!=null&&o.length)){r.notFoundMes.classList.add("not-found--visible"),E(document.querySelectorAll(".categories__btn"),"categories__btn--active");return}d(o),y(document.querySelectorAll(".categories__btn"),document.querySelector(".categories__btn"),"categories__btn--active")}catch(o){console.error("Problems witch searching products:",o)}r.notFoundMes.classList.remove("not-found--visible")}async function V(t){r.searchForm.reset(),r.notFoundMes.classList.remove("not-found--visible"),y(document.querySelectorAll(".categories__btn"),document.querySelector(".categories__btn"),"categories__btn--active");try{r.productsList.innerHTML="";const{products:e}=await C(v);d(e)}catch(e){console.error("Problems during searching products:",e)}}async function M(){if(f(l,s)?s.splice(s.findIndex(t=>t===l),1):s.push(l),b(l,s,i),A("cart",s),u("cart",s.length),document.title==="Cart")try{const t=await h(s),e=T(t,s);r.productsList.innerHTML="",d(t),S(s,e)}catch(t){console.error(`Error with wishlist page, ${t}`)}}async function O(){if(f(l,i)?i.splice(i.findIndex(t=>t===l),1):i.push(l),b(l,s,i),A("wishlist",i),u("wishlist",i.length),document.title==="Wishlist")try{const t=await h(i);r.productsList.innerHTML="",d(t)}catch(t){console.error(`Error with wishlist page, ${t}`)}}async function Q(){s=p("cart")??[],i=p("wishlist")??[],u("cart",s.length),u("wishlist",i.length);try{const t=await h(i);r.productsList.innerHTML="",d(t)}catch(t){console.error(`Error init wishlist page, ${t}`)}}async function X(){s=p("cart")??[],i=p("wishlist")??[],u("cart",s.length),u("wishlist",i.length),S(s);try{const t=await h(s),e=T(t,s);r.productsList.innerHTML="",d(t),S(t,e)}catch(t){console.error(`Error init cart page, ${t}`)}}export{G as a,J as b,V as c,z as d,X as e,K as h,Q as i,r};
//# sourceMappingURL=handlers-C2qAIdP8.js.map
